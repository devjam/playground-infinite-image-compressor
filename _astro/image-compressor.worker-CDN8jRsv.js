(function(){"use strict";self.onmessage=async function(r){const{imageData:c,minQuality:e,maxQuality:i,format:m}=r.data,g=async t=>{const a=await createImageBitmap(t),s=new OffscreenCanvas(a.width,a.height),o=s.getContext("2d");if(!o)throw new Error("Failed to get canvas context");o.drawImage(a,0,0,a.width,a.height);const n=Math.random()*(i-e)+e;return{blob:await s.convertToBlob({type:"image/"+m,quality:n}),quality:n}};try{const t=await g(c);self.postMessage({status:"success",compressedBlob:t.blob,quality:t.quality})}catch(t){self.postMessage({status:"error",message:t instanceof Error?t.message:"Unknown error"})}}})();
